package pl.edu.agh.vision3;

import android.Manifest;
import android.content.Context;
import android.content.pm.PackageManager;
import android.os.Bundle;
import android.support.v4.app.ActivityCompat;
import android.support.v7.app.AppCompatActivity;
import android.util.Log;
import android.view.SurfaceView;
import android.view.WindowManager;
import android.widget.TextView;
import android.widget.Toast;

import org.opencv.android.BaseLoaderCallback;
import org.opencv.android.CameraBridgeViewBase;
import org.opencv.android.LoaderCallbackInterface;
import org.opencv.android.OpenCVLoader;
import org.opencv.core.Core;
import org.opencv.core.Mat;
import org.opencv.core.MatOfRect;
import org.opencv.core.Point;
import org.opencv.core.Rect;
import org.opencv.core.Scalar;
import org.opencv.core.Size;
import org.opencv.imgproc.Imgproc;
import org.opencv.objdetect.CascadeClassifier;
import org.tensorflow.contrib.android.TensorFlowInferenceInterface;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.nio.FloatBuffer;
import java.util.List;
import java.util.concurrent.atomic.AtomicInteger;

public class MainActivity extends AppCompatActivity implements CameraBridgeViewBase.CvCameraViewListener2 {

    private static final String TAG = "OCVSample::Activity";
    private static final int FRONT_CAMERA_INDEX = 1;
    private CameraBridgeViewBase _cameraBridgeViewBase;
    private TextView mTextView;
    private TextView mBottomTextView;
    private TensorFlowInferenceInterface inferenceInterface;

    static {
        System.loadLibrary("tensorflow_inference");
    }

    private static final String MODEL_FILE = "file:///android_asset/sight_vector_model.pb";
    private static final String INPUT_NODE = "input_2";
    private static final String OUTPUT_NODE = "output_node0";

    private static final int[] INPUT_SIZE = {1, 35, 55, 1};

    private BaseLoaderCallback _baseLoaderCallback = new BaseLoaderCallback(this) {
        @Override
        public void onManagerConnected(int status) {
            switch (status) {
                case LoaderCallbackInterface.SUCCESS: {
                    Log.i(TAG, "OpenCV loaded successfully");
                    // Load ndk built module, as specified in moduleName in build.gradle
                    // after opencv initialization
                    System.loadLibrary("native-lib");
                    loadFaceCascade();
                    loadEyeCascade();
                    _cameraBridgeViewBase.enableView();
                }
                break;
                default: {
                    super.onManagerConnected(status);
                }
            }
        }
    };
    private CascadeClassifier mEyeDetector;

    private void loadEyeCascade() {
        // Load native library after(!) OpenCV initialization
        // System.loadLibrary("detection_based_tracker");

        try {
            // load cascade file from application resources
            InputStream is = getResources().openRawResource(R.raw.haarcascade_eye);
            File cascadeDir = getDir("cascade", Context.MODE_PRIVATE);
            File mCascadeFile = new File(cascadeDir, "haarcascade_eye.xml");
            FileOutputStream os = new FileOutputStream(mCascadeFile);

            byte[] buffer = new byte[4096];
            int bytesRead;
            while ((bytesRead = is.read(buffer)) != -1) {
                os.write(buffer, 0, bytesRead);
            }
            is.close();
            os.close();

            String path = mCascadeFile.getAbsolutePath();
            mEyeDetector = new CascadeClassifier(path);
            if (mEyeDetector.empty()) {
                Log.e(TAG, "Failed to load cascade classifier");
                mEyeDetector = null;
            } else
                Log.i(TAG, "Loaded cascade classifier from " + mCascadeFile.getAbsolutePath());

            mEyeDetector.load(path);

            cascadeDir.delete();

        } catch (IOException e) {
            e.printStackTrace();
            Log.e(TAG, "Failed to load cascade. Exception thrown: " + e);
        }
    }

    private CascadeClassifier mFaceDetector;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
        setContentView(R.layout.activity_main);
        mTextView = findViewById(R.id.info);
        mBottomTextView = findViewById(R.id.orientation_text);
        // Permissions for Android 6+
        ActivityCompat.requestPermissions(MainActivity.this,
                new String[]{Manifest.permission.CAMERA},
                1);

        _cameraBridgeViewBase = (CameraBridgeViewBase) findViewById(R.id.main_surface);
        _cameraBridgeViewBase.setVisibility(SurfaceView.VISIBLE);
        _cameraBridgeViewBase.setCameraIndex(FRONT_CAMERA_INDEX);
        _cameraBridgeViewBase.setCvCameraViewListener(this);

        inferenceInterface = new TensorFlowInferenceInterface();
        inferenceInterface.initializeTensorFlow(getAssets(), MODEL_FILE);
    }

    private void loadFaceCascade() {
        try {
            // load cascade file from application resources
            InputStream is = getResources().openRawResource(R.raw.haarcascade_frontalface_default);
            File cascadeDir = getDir("cascade", Context.MODE_PRIVATE);
            File mCascadeFile = new File(cascadeDir, "haarcascade_frontalface_default.xml");
            FileOutputStream os = new FileOutputStream(mCascadeFile);

            byte[] buffer = new byte[4096];
            int bytesRead;
            while ((bytesRead = is.read(buffer)) != -1) {
                os.write(buffer, 0, bytesRead);
            }
            is.close();
            os.close();

            String path = mCascadeFile.getAbsolutePath();
            mFaceDetector = new CascadeClassifier(path);
            if (mFaceDetector.empty()) {
                Log.e(TAG, "Failed to load cascade classifier");
                mFaceDetector = null;
            } else
                Log.i(TAG, "Loaded cascade classifier from " + mCascadeFile.getAbsolutePath());

            mFaceDetector.load(path);

            cascadeDir.delete();

        } catch (IOException e) {
            e.printStackTrace();
            Log.e(TAG, "Failed to load cascade. Exception thrown: " + e);
        }

    }

    @Override
    public void onPause() {
        super.onPause();
        disableCamera();
    }

    @Override
    public void onResume() {
        super.onResume();
        if (!OpenCVLoader.initDebug()) {
            Log.d(TAG, "Internal OpenCV library not found. Using OpenCV Manager for initialization");
            OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_3_4_0, this, _baseLoaderCallback);
        } else {
            Log.d(TAG, "OpenCV library found inside package. Using it!");
            _baseLoaderCallback.onManagerConnected(LoaderCallbackInterface.SUCCESS);
        }
    }

    @Override
    public void onRequestPermissionsResult(int requestCode, String permissions[], int[] grantResults) {
        switch (requestCode) {
            case 1: {
                if (grantResults.length > 0
                        && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                } else {
                    Toast.makeText(MainActivity.this, "Permission denied to read your External storage", Toast.LENGTH_SHORT).show();
                }
                return;
            }
        }
    }

    public void onDestroy() {
        super.onDestroy();
        disableCamera();
    }

    public void disableCamera() {
        if (_cameraBridgeViewBase != null)
            _cameraBridgeViewBase.disableView();
    }

    public void onCameraViewStarted(int width, int height) {
    }

    public void onCameraViewStopped() {
    }

    AtomicInteger counter = new AtomicInteger();
    public Mat onCameraFrame(CameraBridgeViewBase.CvCameraViewFrame inputFrame) {
        Mat legsUpsideMatGray = inputFrame.gray();  // ;D
        Mat matGray = new Mat();
        Core.rotate(legsUpsideMatGray, matGray, Core.ROTATE_180);
//        if (counter.getAndIncrement() > 3) {
//            counter.set(0);
//            return matGray;
//        }
        try {
            // salt(matGray.getNativeObjAddr(), 2000);
            MatOfRect matOfRect = new MatOfRect();
            mFaceDetector.detectMultiScale(matGray.t(), matOfRect);

            final List<Rect> rects = matOfRect.toList();
            double max = 0;
            Rect faceRec = null;
            for (Rect r : rects) {
                if (r.area() > max) {
                    max = r.area();
                    faceRec = r;
                }
            }

            this.runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    if (!rects.isEmpty()) {
                        String text = "Found: " + rects.size() + " , 1st: ["
                                + rects.get(0).y + ","
                                + rects.get(0).x + ","
                                + rects.get(0).width + ","
                                + rects.get(0).height + "]";
                        mTextView.setText(text);
                    } else {
                        mTextView.setText("Shit, no faces.");
                    }
                }
            });

            if (faceRec != null) {
                Imgproc.rectangle(matGray,
                        new Point(faceRec.y, faceRec.x),
                        new Point(faceRec.y + faceRec.height, faceRec.x + faceRec.width),
                        new Scalar(0, 255, 0, 255),
                        10);

                Rect normalizedFace = new Rect(faceRec.y, faceRec.x, faceRec.height, faceRec.width);
                Mat faceMat = matGray.submat(normalizedFace);

                MatOfRect eyeMatOfRect = new MatOfRect();
                mEyeDetector.detectMultiScale(faceMat.t(), eyeMatOfRect);

                final List<Rect> eyeRects = eyeMatOfRect.toList();

                if (eyeRects != null && eyeRects.size() > 0) {
                    double biggestSize = 0;
                    double secondBiggestSize = 0;
                    Rect biggestRec = null;
                    Rect secondBiggestRec = null;
                    for (Rect r : eyeRects) {
                        if (r.area() > 0.3 * faceRec.area()) {
                            continue;
                        }
                        if (r.area() > biggestSize) {
                            secondBiggestRec = biggestRec;
                            biggestRec = r;
                            secondBiggestSize = biggestSize;
                            biggestSize = r.area();
                        } else if (r.area() > secondBiggestSize) {
                            secondBiggestRec = r;
                            secondBiggestSize = r.area();
                        }
                    }

//                    Imgproc.rectangle(matGray,
//                            new Point(faceRec.y + biggestRec.y, faceRec.x + biggestRec.x),
//                            new Point(faceRec.y + biggestRec.y + biggestRec.height, faceRec.x + biggestRec.x + biggestRec.width),
//                            new Scalar(0, 255, 255, 255),
//                            2);

                    Mat out = runRecognition(faceMat, faceRec, biggestRec, matGray);

                    Imgproc.circle(matGray,
                            new Point(faceRec.y + biggestRec.y + (biggestRec.height/2), faceRec.x + biggestRec.x + (biggestRec.width/2)),
                            (biggestRec.height + biggestRec.width)/4,
                            new Scalar(0, 255, 255, 255),
                            2);

//                    Size s = matGray.size();
//                    Mat newOut = new Mat();
//                    Imgproc.resize(out, newOut, s);
//                    matGray = newOut;


                    if (secondBiggestRec != null) {
                        runRecognition(faceMat, faceRec, secondBiggestRec, matGray);
                        Imgproc.circle(matGray,
                                new Point(faceRec.y + secondBiggestRec.y + (secondBiggestRec.height/2), faceRec.x + secondBiggestRec.x + (secondBiggestRec.width/2)),
                                (secondBiggestRec.height + secondBiggestRec.width)/4,
                                new Scalar(0, 255, 255, 255),
                                2);
//                        Imgproc.rectangle(matGray,
//                                new Point(faceRec.y + secondBiggestRec.y, faceRec.x + secondBiggestRec.x),
//                                new Point(faceRec.y + secondBiggestRec.y + secondBiggestRec.height, faceRec.x + secondBiggestRec.x + secondBiggestRec.width),
//                                new Scalar(0, 255, 255, 255),
//                                1);
                    }
                }
            }


        } catch (Exception e) {
            Log.e(TAG, "Failed detection: " + e.getMessage(), e);
        }

        return matGray;
    }

    private Mat runRecognition(Mat inFaceMat, Rect faceRec, Rect eyeRec, Mat outputMatGray) {
        Mat faceMat = inFaceMat.t();//new Mat();
        Mat rawEyeMat = faceMat.submat(eyeRec);
        Mat eyeMat = new Mat();
        Size size = new Size();
        size.width = 55;
        size.height = 35;
        Imgproc.resize(rawEyeMat, eyeMat, size);

        // running recognition

        float[] inputFloats = new float[eyeMat.width() * eyeMat.height()];
//        float[] inputFloats =
//                new float[]
//                        {
//                0.30588235f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29019608f,
//                        0.28235294f,
//                        0.27843137f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.25882353f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.24705882f,
//                        0.25882353f,
//                        0.2627451f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.2627451f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31764706f,
//                        0.3254902f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.34509804f,
//                        0.35294118f,
//                        0.35686275f,
//                        0.36470588f,
//                        0.36862745f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.25882353f,
//                        0.25490196f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.24313725f,
//                        0.24705882f,
//                        0.2627451f,
//                        0.26666667f,
//                        0.26666667f,
//                        0.25882353f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25882353f,
//                        0.26666667f,
//                        0.2745098f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.34509804f,
//                        0.36862745f,
//                        0.37647059f,
//                        0.37647059f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.25882353f,
//                        0.25490196f,
//                        0.25490196f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.25882353f,
//                        0.2627451f,
//                        0.2627451f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.2627451f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.33333333f,
//                        0.36078431f,
//                        0.37254902f,
//                        0.37647059f,
//                        0.2745098f,
//                        0.28235294f,
//                        0.27843137f,
//                        0.26666667f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.2627451f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.34509804f,
//                        0.36078431f,
//                        0.37254902f,
//                        0.2627451f,
//                        0.26666667f,
//                        0.26666667f,
//                        0.25098039f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.22745098f,
//                        0.22745098f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.22745098f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.2627451f,
//                        0.26666667f,
//                        0.27058824f,
//                        0.27843137f,
//                        0.28627451f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.33333333f,
//                        0.35294118f,
//                        0.36862745f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.24313725f,
//                        0.23137255f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21960784f,
//                        0.21960784f,
//                        0.22745098f,
//                        0.22745098f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.24313725f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.25882353f,
//                        0.25882353f,
//                        0.25490196f,
//                        0.26666667f,
//                        0.27843137f,
//                        0.29411765f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.3254902f,
//                        0.34509804f,
//                        0.35686275f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.23137255f,
//                        0.24313725f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25882353f,
//                        0.27058824f,
//                        0.28627451f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.31764706f,
//                        0.3372549f,
//                        0.25098039f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.21568627f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.22745098f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.25098039f,
//                        0.2627451f,
//                        0.27058824f,
//                        0.2745098f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.30196078f,
//                        0.31764706f,
//                        0.26666667f,
//                        0.25490196f,
//                        0.24313725f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.21568627f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.23137255f,
//                        0.23921569f,
//                        0.25098039f,
//                        0.2627451f,
//                        0.27058824f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.30196078f,
//                        0.31372549f,
//                        0.3254902f,
//                        0.33333333f,
//                        0.33333333f,
//                        0.32941176f,
//                        0.3372549f,
//                        0.34117647f,
//                        0.33333333f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.29019608f,
//                        0.2745098f,
//                        0.29411765f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.27843137f,
//                        0.2627451f,
//                        0.24705882f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.21568627f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20784314f,
//                        0.21568627f,
//                        0.22745098f,
//                        0.23529412f,
//                        0.24313725f,
//                        0.25098039f,
//                        0.2627451f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.30196078f,
//                        0.3254902f,
//                        0.34509804f,
//                        0.35686275f,
//                        0.37254902f,
//                        0.37647059f,
//                        0.38039216f,
//                        0.38823529f,
//                        0.39607843f,
//                        0.39215686f,
//                        0.37647059f,
//                        0.37254902f,
//                        0.36470588f,
//                        0.35686275f,
//                        0.36078431f,
//                        0.35294118f,
//                        0.32941176f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.2745098f,
//                        0.25882353f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.2f,
//                        0.2f,
//                        0.2f,
//                        0.2f,
//                        0.20784314f,
//                        0.21568627f,
//                        0.22352941f,
//                        0.23529412f,
//                        0.24313725f,
//                        0.24705882f,
//                        0.25490196f,
//                        0.26666667f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.29411765f,
//                        0.30588235f,
//                        0.34117647f,
//                        0.36862745f,
//                        0.38823529f,
//                        0.39607843f,
//                        0.40784314f,
//                        0.41176471f,
//                        0.41568627f,
//                        0.41960784f,
//                        0.41960784f,
//                        0.41568627f,
//                        0.41568627f,
//                        0.41568627f,
//                        0.41568627f,
//                        0.42745098f,
//                        0.42745098f,
//                        0.40392157f,
//                        0.35686275f,
//                        0.32156863f,
//                        0.29411765f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.25882353f,
//                        0.24313725f,
//                        0.23137255f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21176471f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.2f,
//                        0.2f,
//                        0.2f,
//                        0.20784314f,
//                        0.21568627f,
//                        0.22352941f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.24313725f,
//                        0.25490196f,
//                        0.27058824f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.29411765f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.3254902f,
//                        0.34509804f,
//                        0.36862745f,
//                        0.38039216f,
//                        0.39215686f,
//                        0.4f,
//                        0.40392157f,
//                        0.40392157f,
//                        0.40392157f,
//                        0.41176471f,
//                        0.43529412f,
//                        0.45098039f,
//                        0.4627451f,
//                        0.48235294f,
//                        0.47843137f,
//                        0.45882353f,
//                        0.41960784f,
//                        0.37647059f,
//                        0.3254902f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.25098039f,
//                        0.23529412f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.19607843f,
//                        0.2f,
//                        0.2f,
//                        0.20392157f,
//                        0.21568627f,
//                        0.22352941f,
//                        0.22745098f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.24705882f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.25882353f,
//                        0.27843137f,
//                        0.30196078f,
//                        0.31764706f,
//                        0.3372549f,
//                        0.34901961f,
//                        0.36078431f,
//                        0.37254902f,
//                        0.41960784f,
//                        0.46666667f,
//                        0.49411765f,
//                        0.46666667f,
//                        0.44313725f,
//                        0.43529412f,
//                        0.41568627f,
//                        0.39607843f,
//                        0.36470588f,
//                        0.31372549f,
//                        0.29019608f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.24705882f,
//                        0.23529412f,
//                        0.23137255f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.2f,
//                        0.19607843f,
//                        0.19607843f,
//                        0.2f,
//                        0.20784314f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.22745098f,
//                        0.22745098f,
//                        0.22745098f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.19607843f,
//                        0.18823529f,
//                        0.17647059f,
//                        0.16862745f,
//                        0.17254902f,
//                        0.16078431f,
//                        0.14509804f,
//                        0.16078431f,
//                        0.16862745f,
//                        0.18431373f,
//                        0.21568627f,
//                        0.24313725f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.27058824f,
//                        0.31372549f,
//                        0.35686275f,
//                        0.38039216f,
//                        0.38431373f,
//                        0.39215686f,
//                        0.40784314f,
//                        0.40392157f,
//                        0.39607843f,
//                        0.38431373f,
//                        0.34509804f,
//                        0.31372549f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.24313725f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.2f,
//                        0.2f,
//                        0.2f,
//                        0.20784314f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.21568627f,
//                        0.21568627f,
//                        0.2f,
//                        0.18431373f,
//                        0.16862745f,
//                        0.15294118f,
//                        0.14117647f,
//                        0.13333333f,
//                        0.12941176f,
//                        0.1254902f,
//                        0.10980392f,
//                        0.09411765f,
//                        0.11372549f,
//                        0.11372549f,
//                        0.11764706f,
//                        0.14117647f,
//                        0.15294118f,
//                        0.16078431f,
//                        0.17254902f,
//                        0.19215686f,
//                        0.22352941f,
//                        0.25490196f,
//                        0.2745098f,
//                        0.29803922f,
//                        0.32941176f,
//                        0.36078431f,
//                        0.37647059f,
//                        0.38431373f,
//                        0.38039216f,
//                        0.35686275f,
//                        0.32941176f,
//                        0.30980392f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.23137255f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.20784314f,
//                        0.18039216f,
//                        0.15686275f,
//                        0.1372549f,
//                        0.1254902f,
//                        0.11372549f,
//                        0.10588235f,
//                        0.10588235f,
//                        0.09803922f,
//                        0.09411765f,
//                        0.08627451f,
//                        0.10196078f,
//                        0.10196078f,
//                        0.10588235f,
//                        0.10980392f,
//                        0.10980392f,
//                        0.12156863f,
//                        0.1372549f,
//                        0.15686275f,
//                        0.17647059f,
//                        0.19607843f,
//                        0.20784314f,
//                        0.23137255f,
//                        0.25490196f,
//                        0.28235294f,
//                        0.3254902f,
//                        0.34509804f,
//                        0.34901961f,
//                        0.34901961f,
//                        0.33333333f,
//                        0.31764706f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.2627451f,
//                        0.26666667f,
//                        0.26666667f,
//                        0.2627451f,
//                        0.25098039f,
//                        0.23921569f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.21568627f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.22745098f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.21176471f,
//                        0.16862745f,
//                        0.14117647f,
//                        0.12941176f,
//                        0.12941176f,
//                        0.11372549f,
//                        0.09803922f,
//                        0.08627451f,
//                        0.09019608f,
//                        0.09019608f,
//                        0.09411765f,
//                        0.10196078f,
//                        0.10196078f,
//                        0.10588235f,
//                        0.10980392f,
//                        0.12941176f,
//                        0.14117647f,
//                        0.14901961f,
//                        0.15686275f,
//                        0.16862745f,
//                        0.18039216f,
//                        0.19215686f,
//                        0.19607843f,
//                        0.19215686f,
//                        0.18823529f,
//                        0.24313725f,
//                        0.2745098f,
//                        0.29411765f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.27058824f,
//                        0.24705882f,
//                        0.22745098f,
//                        0.21960784f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.23137255f,
//                        0.30196078f,
//                        0.3372549f,
//                        0.3254902f,
//                        0.25490196f,
//                        0.18823529f,
//                        0.16078431f,
//                        0.15294118f,
//                        0.14117647f,
//                        0.11764706f,
//                        0.09803922f,
//                        0.09019608f,
//                        0.09019608f,
//                        0.09019608f,
//                        0.09019608f,
//                        0.09019608f,
//                        0.08627451f,
//                        0.09411765f,
//                        0.11372549f,
//                        0.13333333f,
//                        0.15294118f,
//                        0.16470588f,
//                        0.18431373f,
//                        0.20392157f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.22745098f,
//                        0.25098039f,
//                        0.27058824f,
//                        0.28627451f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.27058824f,
//                        0.23529412f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.20392157f,
//                        0.21176471f,
//                        0.22745098f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.24705882f,
//                        0.2745098f,
//                        0.31764706f,
//                        0.35294118f,
//                        0.35294118f,
//                        0.30588235f,
//                        0.21568627f,
//                        0.17647059f,
//                        0.16078431f,
//                        0.14509804f,
//                        0.12156863f,
//                        0.10196078f,
//                        0.09411765f,
//                        0.09019608f,
//                        0.08627451f,
//                        0.08627451f,
//                        0.07843137f,
//                        0.0745098f,
//                        0.08627451f,
//                        0.1254902f,
//                        0.14509804f,
//                        0.16470588f,
//                        0.18039216f,
//                        0.21176471f,
//                        0.22745098f,
//                        0.23137255f,
//                        0.21568627f,
//                        0.2f,
//                        0.19607843f,
//                        0.20784314f,
//                        0.21960784f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.22352941f,
//                        0.23921569f,
//                        0.25490196f,
//                        0.27058824f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.26666667f,
//                        0.23137255f,
//                        0.2f,
//                        0.20392157f,
//                        0.20784314f,
//                        0.21176471f,
//                        0.21568627f,
//                        0.22745098f,
//                        0.23921569f,
//                        0.25098039f,
//                        0.25882353f,
//                        0.27058824f,
//                        0.29019608f,
//                        0.3254902f,
//                        0.35294118f,
//                        0.36078431f,
//                        0.34117647f,
//                        0.26666667f,
//                        0.20784314f,
//                        0.16862745f,
//                        0.16078431f,
//                        0.13333333f,
//                        0.10980392f,
//                        0.09019608f,
//                        0.08235294f,
//                        0.07843137f,
//                        0.07843137f,
//                        0.07058824f,
//                        0.08235294f,
//                        0.10588235f,
//                        0.14117647f,
//                        0.15294118f,
//                        0.17647059f,
//                        0.21568627f,
//                        0.2627451f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.25490196f,
//                        0.22745098f,
//                        0.21176471f,
//                        0.21176471f,
//                        0.21960784f,
//                        0.21960784f,
//                        0.21568627f,
//                        0.21960784f,
//                        0.22352941f,
//                        0.23137255f,
//                        0.24313725f,
//                        0.2627451f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.29411765f,
//                        0.2745098f,
//                        0.24705882f,
//                        0.22352941f,
//                        0.22352941f,
//                        0.23137255f,
//                        0.23529412f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.24705882f,
//                        0.25882353f,
//                        0.27058824f,
//                        0.27843137f,
//                        0.29411765f,
//                        0.31764706f,
//                        0.34117647f,
//                        0.35294118f,
//                        0.34901961f,
//                        0.30196078f,
//                        0.25098039f,
//                        0.20392157f,
//                        0.18431373f,
//                        0.15686275f,
//                        0.1254902f,
//                        0.10588235f,
//                        0.09803922f,
//                        0.09411765f,
//                        0.09411765f,
//                        0.09803922f,
//                        0.11764706f,
//                        0.1372549f,
//                        0.15294118f,
//                        0.17647059f,
//                        0.22352941f,
//                        0.28627451f,
//                        0.30196078f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.29411765f,
//                        0.26666667f,
//                        0.24705882f,
//                        0.24313725f,
//                        0.24313725f,
//                        0.23921569f,
//                        0.23529412f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.23921569f,
//                        0.25098039f,
//                        0.26666667f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.28235294f,
//                        0.26666667f,
//                        0.25882353f,
//                        0.25490196f,
//                        0.25490196f,
//                        0.25098039f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.25882353f,
//                        0.2745098f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.30588235f,
//                        0.32156863f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.30980392f,
//                        0.27843137f,
//                        0.24705882f,
//                        0.21568627f,
//                        0.18823529f,
//                        0.16078431f,
//                        0.1372549f,
//                        0.13333333f,
//                        0.12941176f,
//                        0.12941176f,
//                        0.14509804f,
//                        0.15686275f,
//                        0.16470588f,
//                        0.17254902f,
//                        0.23137255f,
//                        0.28627451f,
//                        0.33333333f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.2745098f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.32941176f,
//                        0.32156863f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.28627451f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.2627451f,
//                        0.25882353f,
//                        0.25882353f,
//                        0.2627451f,
//                        0.2745098f,
//                        0.28627451f,
//                        0.29411765f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31764706f,
//                        0.30196078f,
//                        0.29019608f,
//                        0.2745098f,
//                        0.25098039f,
//                        0.22745098f,
//                        0.20392157f,
//                        0.17647059f,
//                        0.17254902f,
//                        0.16862745f,
//                        0.17254902f,
//                        0.17647059f,
//                        0.18431373f,
//                        0.2f,
//                        0.23137255f,
//                        0.29803922f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.29803922f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.30588235f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.33333333f,
//                        0.32156863f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.30196078f,
//                        0.28235294f,
//                        0.27058824f,
//                        0.2745098f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.27843137f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29019608f,
//                        0.27843137f,
//                        0.25882353f,
//                        0.23921569f,
//                        0.21960784f,
//                        0.20784314f,
//                        0.20392157f,
//                        0.21176471f,
//                        0.21960784f,
//                        0.23921569f,
//                        0.2745098f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.31372549f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.34117647f,
//                        0.35294118f,
//                        0.35294118f,
//                        0.34901961f,
//                        0.32941176f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.30588235f,
//                        0.29019608f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.27058824f,
//                        0.27843137f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.28235294f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.25098039f,
//                        0.25490196f,
//                        0.27058824f,
//                        0.29019608f,
//                        0.30980392f,
//                        0.32941176f,
//                        0.3372549f,
//                        0.3254902f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3372549f,
//                        0.35294118f,
//                        0.36078431f,
//                        0.36078431f,
//                        0.36470588f,
//                        0.36470588f,
//                        0.36862745f,
//                        0.37647059f,
//                        0.39607843f,
//                        0.39607843f,
//                        0.39215686f,
//                        0.34509804f,
//                        0.3254902f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.29803922f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.27058824f,
//                        0.2745098f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.27058824f,
//                        0.2627451f,
//                        0.25882353f,
//                        0.26666667f,
//                        0.27843137f,
//                        0.28627451f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.27843137f,
//                        0.28627451f,
//                        0.30196078f,
//                        0.32156863f,
//                        0.32941176f,
//                        0.33333333f,
//                        0.32941176f,
//                        0.3254902f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.3372549f,
//                        0.34901961f,
//                        0.36078431f,
//                        0.37254902f,
//                        0.38039216f,
//                        0.38431373f,
//                        0.39607843f,
//                        0.41960784f,
//                        0.43529412f,
//                        0.43529412f,
//                        0.42745098f,
//                        0.36862745f,
//                        0.3372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.31372549f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.26666667f,
//                        0.25882353f,
//                        0.25490196f,
//                        0.25882353f,
//                        0.2745098f,
//                        0.28627451f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.30196078f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.32156863f,
//                        0.32941176f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.33333333f,
//                        0.34117647f,
//                        0.36078431f,
//                        0.38039216f,
//                        0.39215686f,
//                        0.39607843f,
//                        0.41176471f,
//                        0.43921569f,
//                        0.44705882f,
//                        0.45098039f,
//                        0.45098039f,
//                        0.38431373f,
//                        0.34901961f,
//                        0.32156863f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.27843137f,
//                        0.2745098f,
//                        0.27058824f,
//                        0.26666667f,
//                        0.2627451f,
//                        0.27058824f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29019608f,
//                        0.29803922f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.32156863f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.35294118f,
//                        0.37254902f,
//                        0.38823529f,
//                        0.39607843f,
//                        0.40392157f,
//                        0.41960784f,
//                        0.44313725f,
//                        0.44313725f,
//                        0.45490196f,
//                        0.4627451f,
//                        0.39215686f,
//                        0.36078431f,
//                        0.32941176f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29019608f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.27843137f,
//                        0.28235294f,
//                        0.29019608f,
//                        0.30196078f,
//                        0.30980392f,
//                        0.31764706f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.34509804f,
//                        0.38039216f,
//                        0.39215686f,
//                        0.39215686f,
//                        0.39607843f,
//                        0.41176471f,
//                        0.43137255f,
//                        0.45098039f,
//                        0.44705882f,
//                        0.45490196f,
//                        0.4745098f,
//                        0.41176471f,
//                        0.40784314f,
//                        0.38823529f,
//                        0.34509804f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.32941176f,
//                        0.32941176f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30196078f,
//                        0.29803922f,
//                        0.29019608f,
//                        0.28235294f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28627451f,
//                        0.28235294f,
//                        0.28627451f,
//                        0.30196078f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.34901961f,
//                        0.37647059f,
//                        0.39215686f,
//                        0.39607843f,
//                        0.4f,
//                        0.40784314f,
//                        0.42352941f,
//                        0.44313725f,
//                        0.4627451f,
//                        0.45098039f,
//                        0.48235294f,
//                        0.53333333f,
//                        0.40784314f,
//                        0.41176471f,
//                        0.41176471f,
//                        0.40392157f,
//                        0.37647059f,
//                        0.36078431f,
//                        0.34901961f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.34117647f,
//                        0.34117647f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.33333333f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.3254902f,
//                        0.31764706f,
//                        0.30980392f,
//                        0.30196078f,
//                        0.29411765f,
//                        0.28627451f,
//                        0.29019608f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.29411765f,
//                        0.29411765f,
//                        0.29803922f,
//                        0.29803922f,
//                        0.30196078f,
//                        0.30980392f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.3254902f,
//                        0.33333333f,
//                        0.34117647f,
//                        0.34117647f,
//                        0.34509804f,
//                        0.36078431f,
//                        0.38039216f,
//                        0.39215686f,
//                        0.40392157f,
//                        0.41568627f,
//                        0.42745098f,
//                        0.44705882f,
//                        0.46666667f,
//                        0.48235294f,
//                        0.50196078f,
//                        0.52941176f,
//                        0.55686275f,
//                        0.43921569f,
//                        0.43137255f,
//                        0.42745098f,
//                        0.42745098f,
//                        0.41176471f,
//                        0.38823529f,
//                        0.36470588f,
//                        0.36078431f,
//                        0.35686275f,
//                        0.35686275f,
//                        0.35686275f,
//                        0.34901961f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.34509804f,
//                        0.34509804f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.3372549f,
//                        0.32941176f,
//                        0.3254902f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.30588235f,
//                        0.30588235f,
//                        0.30980392f,
//                        0.30980392f,
//                        0.31372549f,
//                        0.31372549f,
//                        0.31764706f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.3254902f,
//                        0.31764706f,
//                        0.31372549f,
//                        0.32941176f,
//                        0.34117647f,
//                        0.34901961f,
//                        0.35294118f,
//                        0.36078431f,
//                        0.36862745f,
//                        0.38431373f,
//                        0.39607843f,
//                        0.41176471f,
//                        0.43137255f,
//                        0.44705882f,
//                        0.46666667f,
//                        0.48235294f,
//                        0.49803922f,
//                        0.51372549f,
//                        0.5372549f,
//                        0.56078431f,
//                        0.46666667f,
//                        0.45098039f,
//                        0.43921569f,
//                        0.43921569f,
//                        0.43529412f,
//                        0.41568627f,
//                        0.39215686f,
//                        0.37647059f,
//                        0.37254902f,
//                        0.37254902f,
//                        0.37254902f,
//                        0.36470588f,
//                        0.36078431f,
//                        0.35686275f,
//                        0.35294118f,
//                        0.35294118f,
//                        0.35294118f,
//                        0.35294118f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.34509804f,
//                        0.34117647f,
//                        0.33333333f,
//                        0.32156863f,
//                        0.31764706f,
//                        0.31764706f,
//                        0.32156863f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.3254902f,
//                        0.32941176f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.32941176f,
//                        0.32156863f,
//                        0.32941176f,
//                        0.34509804f,
//                        0.36078431f,
//                        0.36470588f,
//                        0.37647059f,
//                        0.38431373f,
//                        0.38823529f,
//                        0.39607843f,
//                        0.41568627f,
//                        0.43921569f,
//                        0.4627451f,
//                        0.47843137f,
//                        0.49411765f,
//                        0.50196078f,
//                        0.5372549f,
//                        0.56078431f,
//                        0.57254902f,
//                        0.4745098f,
//                        0.46666667f,
//                        0.45490196f,
//                        0.44705882f,
//                        0.45098039f,
//                        0.44313725f,
//                        0.42745098f,
//                        0.40392157f,
//                        0.39215686f,
//                        0.39215686f,
//                        0.38823529f,
//                        0.38039216f,
//                        0.37647059f,
//                        0.37254902f,
//                        0.36470588f,
//                        0.35686275f,
//                        0.35294118f,
//                        0.34901961f,
//                        0.35294118f,
//                        0.36078431f,
//                        0.37647059f,
//                        0.36862745f,
//                        0.36078431f,
//                        0.35294118f,
//                        0.34901961f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.33333333f,
//                        0.33333333f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.3372549f,
//                        0.34117647f,
//                        0.34117647f,
//                        0.34117647f,
//                        0.3372549f,
//                        0.34509804f,
//                        0.35686275f,
//                        0.37254902f,
//                        0.38039216f,
//                        0.38823529f,
//                        0.39607843f,
//                        0.4f,
//                        0.40392157f,
//                        0.42352941f,
//                        0.45098039f,
//                        0.47058824f,
//                        0.49019608f,
//                        0.50588235f,
//                        0.51372549f,
//                        0.57254902f,
//                        0.6f,
//                        0.6f,
//                        0.48235294f,
//                        0.4745098f,
//                        0.47058824f,
//                        0.46666667f,
//                        0.46666667f,
//                        0.4627451f,
//                        0.45490196f,
//                        0.42745098f,
//                        0.41568627f,
//                        0.40784314f,
//                        0.4f,
//                        0.39607843f,
//                        0.39215686f,
//                        0.38431373f,
//                        0.37647059f,
//                        0.35686275f,
//                        0.34117647f,
//                        0.34509804f,
//                        0.35686275f,
//                        0.37647059f,
//                        0.4f,
//                        0.39215686f,
//                        0.38039216f,
//                        0.36078431f,
//                        0.35686275f,
//                        0.35686275f,
//                        0.35686275f,
//                        0.35686275f,
//                        0.34117647f,
//                        0.33333333f,
//                        0.3372549f,
//                        0.34901961f,
//                        0.34509804f,
//                        0.34117647f,
//                        0.3372549f,
//                        0.34901961f,
//                        0.36078431f,
//                        0.36470588f,
//                        0.36862745f,
//                        0.37647059f,
//                        0.38431373f,
//                        0.39607843f,
//                        0.39607843f,
//                        0.40784314f,
//                        0.41960784f,
//                        0.42352941f,
//                        0.43921569f,
//                        0.4627451f,
//                        0.47058824f,
//                        0.49803922f,
//                        0.51764706f,
//                        0.5254902f,
//                        0.59215686f,
//                        0.61960784f,
//                        0.61960784f
//                        };

        for (int i = 0; i < 35; i++) {
            for (int j = 0; j < 55; j++) {
//                eyeMat.put(i,/ j, inputFloats[i * 55 + j] * 255.0);
                inputFloats[i * 55 + j] = (float) (eyeMat.get(i, j)[0] / 255.0);
            }
        }

//        for (int i = 0; i < eyeMat.height(); i++) {
//            for (int j = 0; j < eyeMat.width(); j++) {
//                inputFloats[i * eyeMat.width() + j] = (float) (eyeMat.get(i,j)[0]/255.0);// getting gray
//            }
//        }


        inferenceInterface.fillNodeFloat(INPUT_NODE, INPUT_SIZE, inputFloats);
        inferenceInterface.runInference(new String[]{OUTPUT_NODE});
        final FloatBuffer fb = FloatBuffer.allocate(2);
        inferenceInterface.readNodeIntoFloatBuffer(OUTPUT_NODE, fb);

        this.runOnUiThread(new Runnable() {
            @Override
            public void run() {
                String text = "Direction: [" + fb.get(1) + ", " + fb.get(0) + "]";
                mBottomTextView.setText(text);
            }
        });

        fb.put(1, -fb.get(1));
        Point point = computeCircleCenter(faceRec, eyeRec, fb);
        Point target = new Point();
        target.x = point.x + (fb.get(1) * 5 * 50);
        target.y = point.y + (fb.get(0) * 5 * 50);
        int thickness = 3;
        int line_type = 8;
        int shift = 0;
        double tipLength = 0.1;
        Imgproc.arrowedLine(outputMatGray,
                point,
                target,
                new Scalar(255, 255, 255, 255),
                thickness,
                line_type,
                shift,
                tipLength);

//        Imgproc.circle(outputMatGray,
//                point,
//                10,
//                new Scalar(100, 255, 255, 255),
//                1);
//
//        Imgproc.circle(outputMatGray,
//                point,
//                (int) (1 + (promotion * 16)),
//                new Scalar(255, 255, 255, 255),
//                (int) (1 + (promotion * 18)));
        return eyeMat;
    }

    private Point computeCircleCenter(Rect faceRec, Rect rec, FloatBuffer fb) {
        int bigCenterX = faceRec.y + rec.y + (rec.height/2);
        int bigCenterY = faceRec.x + rec.x + (rec.width/2);
        double radius = Math.pow((rec.height + rec.width)/4, 2);
        double x = Math.sqrt(radius/(1 + Math.pow(fb.get(0)/fb.get(1) , 2)));
        if (fb.get(1) < 0) {
            x*= -1;
        }
        double y = (int) (fb.get(0) / fb.get(1) * x);
        return new Point(bigCenterX + x, bigCenterY + y);
    }


    public native void salt(long matAddrGray, int nbrElem);
}